//serverCredentials : String
// XL Deploy server credentials used to connect to the XL Deploy server. *
// This must be configured under Manage Jenkins >> Configure System >> XL Deploy
 node {

        stage('Clean Workspace') {
            deleteDir() // deletes everything in the workspace
        }

        stage('Checkout') {
            git branch: "main", url: "https://github.com/kagzouli/TestDevopsLiquibase.git"
        }

        // Create the .dar to prepare it to deploy to XLDeploy
        stage('Create .dar'){
            xldCreatePackage artifactsPath: 'src/main/resources', manifestPath: 'xld/deploy-it.xml', darPath: 'testdevopsliquibase-${BUILD_NUMBER}.dar'
        }

        // Create the .dar to prepare it to deploy to XLDeploy
        stage('Publish application'){
            xldPublishPackage serverCredentials: 'xldeploy-cred', darPath: 'testdevopsliquibase-${BUILD_NUMBER}.dar'
         }

        // Deploy to the right environment (dev)
        stage('Deploy to env'){
            xldDeploy serverCredentials: 'xldeploy-cred', environmentId: 'Environments/TEST/EXAKA/loadtest-dev', packageId: 'Applications/TEST/EXAKA/loadtest-uv/1.1.0'
        }
}